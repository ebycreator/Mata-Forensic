<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>META FORENSIC</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/exifreader/dist/exif-reader.min.js"></script>

<style>
body {
    background: #0d0d0d;
    color: #e5e5e5;
    font-family: Arial, sans-serif;
}
.header {
    text-align: center;
    padding: 20px;
    background: #000;
    border-bottom: 2px solid #0ea5e9;
}
.card {
    background: #111;
    padding: 20px;
    margin-top: 20px;
    border: 1px solid #222;
    border-radius: 10px;
}
.heading {
    font-size: 18px;
    font-weight: bold;
    color: #0ea5e9;
}
.metadata-item {
    display: flex;
    justify-content: space-between;
    border-bottom: 1px solid #333;
    padding: 6px 0;
}
.meta-key {
    color: #38bdf8;
    font-weight: bold;
}
.meta-value {
    color: #ddd;
    text-align: right;
}
button {
    background: #0ea5e9;
    padding: 10px 20px;
    border-radius: 6px;
    color: black;
    font-weight: bold;
}
button:hover {
    background: #38bdf8;
}
</style>
</head>

<body>

<div class="header">
    <h1 class="text-4xl font-bold text-white">META FORENSIC</h1>
    <p class="text-lg">Digital Image Metadata Analysis Tool</p>
</div>

<div class="max-w-4xl mx-auto mt-6">

    <div class="card text-center">
        <input type="file" id="fileInput" accept="image/*" class="hidden">
        <button onclick="document.getElementById('fileInput').click()">Upload Image</button>
    </div>

    <div id="imagePreview" class="card hidden">
        <p class="heading">Image Preview</p>
        <img id="previewImg" src="" class="mt-2 rounded max-h-80 mx-auto">
    </div>

    <div id="metadataCard" class="card hidden">
        <p class="heading">Extracted Metadata</p>
        <div id="metadataList"></div>
    </div>

</div>

<script>
// --- HASH FUNCTIONS ---
async function computeHash(buffer, algorithm) {
    const hash = await crypto.subtle.digest(algorithm, buffer);
    return Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2, "0")).join("");
}

// --- HANDLE UPLOAD ---
document.getElementById("fileInput").addEventListener("change", async function () {
    const file = this.files[0];
    if (!file) return;

    // Show preview
    const img = document.getElementById("previewImg");
    img.src = URL.createObjectURL(file);
    document.getElementById("imagePreview").classList.remove("hidden");

    // Read file buffer
    const arrayBuffer = await file.arrayBuffer();

    // Read EXIF Metadata
    const tags = ExifReader.load(arrayBuffer);

    // Compute hashes
    const md5 = await computeHash(arrayBuffer, "MD5");
    const sha1 = await computeHash(arrayBuffer, "SHA-1");
    const sha256 = await computeHash(arrayBuffer, "SHA-256");

    // Build metadata object
    const meta = {
        "File Name": file.name,
        "File Size (KB)": (file.size / 1024).toFixed(2),
        "MIME Type": file.type,
        "MD5 Hash": md5,
        "SHA-1 Hash": sha1,
        "SHA-256 Hash": sha256,
        "Camera Model": tags.Model?.description || "Not Available",
        "Camera Make": tags.Make?.description || "Not Available",
        "Camera Serial Number": tags.SerialNumber?.description || "Not Available",
        "Original Date": tags.DateTimeOriginal?.description || "Not Available",
        "Modified Date": tags.DateTime?.description || "Not Available",
        "Software / Editing App": tags.Software?.description || "Not Available"
    };

    // Display metadata
    const list = document.getElementById("metadataList");
    list.innerHTML = "";

    for (const key in meta) {
        const item = document.createElement("div");
        item.className = "metadata-item";
        item.innerHTML = `
            <div class="meta-key">${key}</div>
            <div class="meta-value">${meta[key]}</div>
        `;
        list.appendChild(item);
    }

    document.getElementById("metadataCard").classList.remove("hidden");
});
</script>

</body>
</html>
